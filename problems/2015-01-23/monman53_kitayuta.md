## 4-1
`repeat` のみ。`repeat`は無限リストを返す。

## 4-2
#### (1)
```haskell
mcount :: Num a => String -> a
mcount "" = 0
mcount (c:cs)
    | c == 'm' = 1 + mcount cs
    | otherwise = mcount cs
```

#### (2)
```haskell
memph :: String -> String
memph "" = ""
memph (c:cs)
    | c `elem` ['m','M'] = "**M**" ++ memph cs
    | otherwise = c : memph cs
```

## 4-3
#### (1)
```haskell
champ :: String
champ = champ' 1
    where champ' n = show n ++ champ' (n+1)
```

#### (2)
あとでやる（迫真）

## 4-4
下記 `split` とほぼ同じ働きをする `splitAt` が Prelude 内に定義されていますが、一応自前で実装しておきました。

```haskell
msort :: (Ord a) => [a] -> [a]
msort [] = []
msort (x:[]) = [x]
msort xs = merge (msort l) (msort r)
    where (l,r) = split (length xs `div` 2) xs

merge :: (Ord a) => [a] -> [a] -> [a]
merge fst [] = fst
merge [] snd = snd
merge fst@(f:frem) snd@(s:srem)
    | f <= s = f : merge frem snd
    | otherwise = s : merge fst srem

split :: Int -> [a] -> ([a],[a])
split _ [] = ([],[])
split 0 xs = ([],xs)
split n (x:xs) = (x:l,r)
    where (l,r) = split (n-1) xs
```

## 5-1
#### (1)
```haskell
lsystem :: (Char -> String) -> String -> Int -> String
lsystem _ st 0 = st
lsystem r st n = lsystem r (update st) (n-1)
    where
        update "" = ""
        update (c:cs) = r c ++ update cs

rules :: Char -> String
rules 'A' = "AB"
rules 'B' = "A"
```

#### (2)
```haskell
penro :: Char -> String
penro 'M' = "O++{.P.----N.[-O.----M.}]++"
penro 'N' = "+{.O.--P.[---M.--N.}]+"
penro 'O' = "-{.M.++N.[+++O.++P.}]-"
penro 'P' = "--{.O.++++M.[+P.++++N.}]--N"
penro c = [c]
```
```
*Main> lsystem penro "[N]++[N]++[N]++[N]++[N]" 3
"[+{.-{.O++{.P.----N.[-O.----M.}]++.+++{.O.--P.[---M.--N.}]+.[+++-{.M.++N.[+++O.++P.}]-.++--{.O.++++M.[+P.++++N.}]--N.}]-.----{.-{.M.++N.[+++O.++P.}]-.++++O++{.P.----N.[-O.----M.}]++.[+--{.O.++++M.[+P.++++N.}]--N.+++++{.O.--P.[---M.--N.}]+.}]--+{.O.--P.[---M.--N.}]+.[----{.M.++N.[+++O.++P.}]-++{.--{.O.++++M.[+P.++++N.}]--N.----+{.O.--P.[---M.--N.}]+.[--{.M.++N.[+++O.++P.}]-.----O++{.P.----N.[-O.----M.}]++.}]++.--+{.-{.M.++N.[+++O.++P.}]-.----{.O.++++M.[+P.++++N.}]--N.[---O++{.P.----N.[-O.----M.}]++.--+{.O.--P.[---M.--N.}]+.}]+.}]+]++[+{.-{.O++{.P.----N.[-O.----M.}]++.+++{.O.--P.[---M.--N.}]+.[+++-{.M.++N.[+++O.++P.}]-.++--{.O.++++M.[+P.++++N.}]--N.}]-.----{.-{.M.++N.[+++O.++P.}]-.++++O++{.P.----N.[-O.----M.}]++.[+--{.O.++++M.[+P.++++N.}]--N.+++++{.O.--P.[---M.--N.}]+.}]--+{.O.--P.[---M.--N.}]+.[----{.M.++N.[+++O.++P.}]-++{.--{.O.++++M.[+P.++++N.}]--N.----+{.O.--P.[---M.--N.}]+.[--{.M.++N.[+++O.++P.}]-.----O++{.P.----N.[-O.----M.}]++.}]++.--+{.-{.M.++N.[+++O.++P.}]-.----{.O.++++M.[+P.++++N.}]--N.[---O++{.P.----N.[-O.----M.}]++.--+{.O.--P.[---M.--N.}]+.}]+.}]+]++[+{.-{.O++{.P.----N.[-O.----M.}]++.+++{.O.--P.[---M.--N.}]+.[+++-{.M.++N.[+++O.++P.}]-.++--{.O.++++M.[+P.++++N.}]--N.}]-.----{.-{.M.++N.[+++O.++P.}]-.++++O++{.P.----N.[-O.----M.}]++.[+--{.O.++++M.[+P.++++N.}]--N.+++++{.O.--P.[---M.--N.}]+.}]--+{.O.--P.[---M.--N.}]+.[----{.M.++N.[+++O.++P.}]-++{.--{.O.++++M.[+P.++++N.}]--N.----+{.O.--P.[---M.--N.}]+.[--{.M.++N.[+++O.++P.}]-.----O++{.P.----N.[-O.----M.}]++.}]++.--+{.-{.M.++N.[+++O.++P.}]-.----{.O.++++M.[+P.++++N.}]--N.[---O++{.P.----N.[-O.----M.}]++.--+{.O.--P.[---M.--N.}]+.}]+.}]+]++[+{.-{.O++{.P.----N.[-O.----M.}]++.+++{.O.--P.[---M.--N.}]+.[+++-{.M.++N.[+++O.++P.}]-.++--{.O.++++M.[+P.++++N.}]--N.}]-.----{.-{.M.++N.[+++O.++P.}]-.++++O++{.P.----N.[-O.----M.}]++.[+--{.O.++++M.[+P.++++N.}]--N.+++++{.O.--P.[---M.--N.}]+.}]--+{.O.--P.[---M.--N.}]+.[----{.M.++N.[+++O.++P.}]-++{.--{.O.++++M.[+P.++++N.}]--N.----+{.O.--P.[---M.--N.}]+.[--{.M.++N.[+++O.++P.}]-.----O++{.P.----N.[-O.----M.}]++.}]++.--+{.-{.M.++N.[+++O.++P.}]-.----{.O.++++M.[+P.++++N.}]--N.[---O++{.P.----N.[-O.----M.}]++.--+{.O.--P.[---M.--N.}]+.}]+.}]+]++[+{.-{.O++{.P.----N.[-O.----M.}]++.+++{.O.--P.[---M.--N.}]+.[+++-{.M.++N.[+++O.++P.}]-.++--{.O.++++M.[+P.++++N.}]--N.}]-.----{.-{.M.++N.[+++O.++P.}]-.++++O++{.P.----N.[-O.----M.}]++.[+--{.O.++++M.[+P.++++N.}]--N.+++++{.O.--P.[---M.--N.}]+.}]--+{.O.--P.[---M.--N.}]+.[----{.M.++N.[+++O.++P.}]-++{.--{.O.++++M.[+P.++++N.}]--N.----+{.O.--P.[---M.--N.}]+.[--{.M.++N.[+++O.++P.}]-.----O++{.P.----N.[-O.----M.}]++.}]++.--+{.-{.M.++N.[+++O.++P.}]-.----{.O.++++M.[+P.++++N.}]--N.[---O++{.P.----N.[-O.----M.}]++.--+{.O.--P.[---M.--N.}]+.}]+.}]+]"
```
